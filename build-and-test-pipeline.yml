name: BuildAndTest
steps:
  - task: DotNetCoreCLI@2
    name: restore
    displayName: Restore
    inputs:
      command: 'restore'
      feedsToUse: 'select'
      vstsFeed: '0f7658ee-3fbc-4cb5-9169-e2d0903fd495'
  - task: DotNetCoreCLI@2
    name: build
    displayName: Build
    inputs:
      command: build
      projects: src/**/*.csproj
  - task: DockerCompose@0
    name: DockerCompose
    inputs:
      containerregistrytype: 'Container Registry'
      dockerComposeFile: 'test/**/docker-compose.yml'
      action: 'Run a Docker Compose command'
      dockerComposeCommand: 'up'
  - task: DotNetCoreCLI@2
    name: test
    displayName: Test
    inputs:
      command: test
      projects: test/**/*.csproj